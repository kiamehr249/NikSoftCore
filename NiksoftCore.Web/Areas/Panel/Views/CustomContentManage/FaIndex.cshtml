@using NiksoftCore.SystemBase.Service
@{
    ViewData["Title"] = "دسته بندی های محتوا";
    Layout = "~/Areas/Panel/Views/Shared/_FaLayout.cshtml";
    var contents = (List<ContentCategory>)ViewBag.Contents;
    var pager = (NiksoftCore.Utilities.Pagination)ViewBag.Pager;
    int pageNumber = 0;
    var parent = (ContentCategory)ViewBag.Parent;
}

<div class="text-right">
    <div class="btn-group">
        @if (parent != null && parent.Id > 0)
        {
            <a href="/Panel/CustomContentManage?ParentId=@parent.ParentId" class="btn btn-outline-info btn-sm">
                <i class="fas fa-arrow-left"></i>
            </a>
        }
    </div>
</div>

<br />
<div class="row">
    @foreach (var item in contents)
    {
        pageNumber++;
        <div class="col-lg-4">
            <div class="card text-center shadow">
                <div class="card-heading">
                    <h4 class="card-title text-muted mb-0">@item.Title</h4>
                </div>
                <div class="card-body p-t-10">
                    <p class="text-muted m-b-20 m-t-0">
                        <img src="/@item.Image" style="max-width: 100%; height: 70px;" />
                    </p>
                    @if (item.Childs.Count > 0)
                    {
                        <a href="/Panel/CustomContentManage?ParentId=@item.Id" class="btn btn-outline-info btn-full">دسته های زیرین</a>
                    }
                    else
                    {
                        <a href="/Panel/CustomContentManage/ContentList?CategoryId=@item.Id" class="btn btn-outline-info btn-full">مدیریت محتوا</a>
                    }

                </div>
            </div>
        </div>
    }
</div>
<div class="pager">
    @if (pager.TotalSize > pager.PageSize)
    {
        <ul class="pagination m-b-5">
            <li class="page-item">
                <a class="page-link" href="@Context.Request.Path?part=1" aria-label="Previous">
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>

            @if (pager.GetStartShow() >= pager.MaxShow)
            {
                <li class="page-item"><a href="@Context.Request.Path?part=@pager.GetBackRang()" class="page-link">...</a></li>
            }

            @for (int i = pager.GetStartShow(); i <= pager.GetEndShow(); i++)
            {
                if (pager.Part == i)
                {
                    <li class="page-item active"><a href="@Context.Request.Path?part=@i" class="page-link">@i</a></li>
                }
                else
                {
                    <li class="page-item"><a href="@Context.Request.Path?part=@i" class="page-link">@i</a></li>
                }

            }

            @if (pager.GetTotalParts() > pager.MaxShow)
            {
                <li class="page-item"><a href="@Context.Request.Path?part=@pager.GetEndShow()" class="page-link">...</a></li>
            }
            <li class="page-item">
                <a class="page-link" href="@Context.Request.Path?part=@pager.GetTotalParts()" aria-label="Next">
                    <i class="fa fa-angle-left"></i>
                </a>
            </li>
        </ul>
    }

</div>